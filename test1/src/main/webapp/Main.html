<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>메인페이지</title>
    <link rel="stylesheet" href="./css/main.css">

</head>
<body>
    <!-- 헤더 영역 -->
<div data-layer="헤더영역 01" class="header">
    <div data-layer="Frame1" class="Frame1">
        <div data-layer="카테고리" class="categories">
            <div data-layer="국내창작" class="category">국내창작</div>
            <div data-layer="라이센스" class="category">라이센스</div>
            <div data-layer="게시판" class="category">게시판</div>
        </div>
        
        <div data-layer="로고영역" class="logo">CURTAIN CALL GUIDE</div>

        <div data-layer="buttons" class="Buttons">
        <div data-layer="btn_sign up" class="BtnSignUp">
            <div data-layer="SIGN UP" class="SignUp">회원가입</div>
        </div>
        <div data-layer="btn_login" class="BtnLogin">
            <div data-layer="Login" class="Login">로그인</div>
        </div>
        <img src="./img/icon_my.png" class="icon_my" alt="My Icon">
        </div>
    </div>
</div>

    <!-- 타이틀 영역 -->




    <!-- 슬라이드 영역 -->
    <section class="slide-list">
        <div class="slide">
            <div class="slide-track">
                <img src="./img/물랑루즈.JPG" alt="Image 1">
                <img src="./img/물랑루즈.JPG" alt="Image 2">
                <img src="./img/tcktck 2.png" alt="Image 3">
                <img src="./img/물랑루즈.JPG" alt="Image 4">
                <img src="./img/tcktck 2.png" alt="Image 5">
            </div>
        </div>
    </section>

<main>
    <!-- 콘텐츠 리스트 섹션 -->
    <section class="content-list">
        <div class="search_frame">
            <div class="whole_list">전체목록</div>
            <input type="text" placeholder="작품명을 입력하세요" class="search">
            </div>

            <div class="content-list__items1">
                <div class="contentList01">
                    <div class="content-item">콘텐츠 1</div>
                    <div class="content-item">콘텐츠 2</div>
                    <div class="content-item">콘텐츠 3</div>
                    <div class="content-item">콘텐츠 4</div>
                    <div class="content-item">콘텐츠 5</div>
                </div>
                <div class="contentList02">
                    <div class="content-item">콘텐츠 1</div>
                    <div class="content-item">콘텐츠 2</div>
                    <div class="content-item">콘텐츠 3</div>
                    <div class="content-item">콘텐츠 4</div>
                    <div class="content-item">콘텐츠 5</div>
                </div>
            </div>
    </section>
</main>

    <script>
        let currentPage = 1;
        const itemsPerPage = 25;

        // 콘텐츠 로드 함수
        async function loadContent(page) {
            try {
                // 서버에서 뮤지컬 데이터 가져오기
                const response = await fetch('http://localhost:8082/test1/MainCon');
                if (!response.ok) {
                    throw new Error(`HTTP 오류! 상태 코드: ${response.status}`);
                }
                const data = await response.json();

                // 현재 페이지의 항목 계산
                const startIndex = (page - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage;
                const currentItems = data.slice(startIndex, endIndex);

                // 콘텐츠 리스트에 추가
                const contentList = document.getElementById('content-list');
                currentItems.forEach(musical => {
                    const item = document.createElement('div');
                    item.className = 'content-item';
                    item.style.textAlign = 'center';

                    // 동적으로 항목 생성
                    item.innerHTML = `
                        <a href="detail.html?musicalIdx=${musical.musicalIdx}">
                            <img src="${musical.musicalPoster}" alt="${musical.musicalTitle}" class="musical-poster" style="width: 250px; height: 250px;">
                            <div>${musical.musicalTitle}</div>
                        </a>
                    `;
                    contentList.appendChild(item);
                });

                // 데이터가 더 이상 없으면 "더 보기" 버튼 숨기기
                if (endIndex >= data.length) {
                    document.getElementById('load-more').style.display = 'none';
                }
            } catch (error) {
                console.error('콘텐츠 로드 중 오류 발생:', error);
            }
        }

        // 페이지 로드 시 데이터 가져오기
        loadContent(currentPage);

        // "더 보기" 버튼 클릭 이벤트
        document.getElementById('load-more').addEventListener('click', () => {
            currentPage++;
            loadContent(currentPage);
        });

        // 버튼 이벤트: 로그인 페이지로 이동
        document.querySelector('.BtnLogin').addEventListener('click', () => {
            window.location.href = 'login.html';
        });
        
        // 버튼 이벤트: 마이 페이지로 이동
        document.querySelector('.icon_my').addEventListener('click', () => {
            window.location.href = 'MyPage.html';
        });

        // 버튼 이벤트: 회원가입 페이지로 이동
        document.querySelector('.BtnSignUp').addEventListener('click', () => {
            window.location.href = 'signUp.html';
        });

        // 게시판 버튼 이벤트
        document.querySelector('.categories .category:nth-child(3)').addEventListener('click', () => {
            window.location.href = 'Board.jsp';
        });
		// 마이페이지 버튼 이벤트
		document.querySelector('.icon_my').addEventListener('click', () => {
            window.location.href = 'MyPage.html';
        });
		
		// 슬라이드 동작 관련
		const slideTrack = document.querySelector('.slide-track');
		const slides = slideTrack.children;
		let currentIndex = 2; // 3번째 이미지부터 시작 (인덱스는 0부터 시작)
		
		function updateSlidePosition() {
		// 트랙 이동: 중앙 이미지를 정렬
		slideTrack.style.transform = `translateX(-${(currentIndex - 2) * 240}px)`;
		
		// 중앙 이미지 확대
		Array.from(slides).forEach((slide, index) => {
		slide.style.transform = index === currentIndex ? 'scale(1.2)' : 'scale(1)';
		slide.style.opacity = index === currentIndex ? '1' : (index === currentIndex - 1 || index === currentIndex + 1 ? '0.5' : '0');
		});
		  }
		
		function nextSlide() {
		currentIndex++;
		if (currentIndex >= slides.length) {
		currentIndex = 2; // 다시 3번째 이미지로 루프
		}
		updateSlidePosition();
		}
		
		// 초기 슬라이드 위치 설정
		updateSlidePosition();
		
		// 자동 슬라이드: 3초마다 이동
		setInterval(nextSlide, 3000);
    </script>
</body>
</html>
